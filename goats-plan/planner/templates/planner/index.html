{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Goat's Plan</title>
    <link rel="stylesheet" href="{% static 'planner/base_style.css' %}">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
        }
        .header {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            background-color: #fff;
            border-bottom: 1px solid #ddd;
        }
        .logo {
            margin-right: 15px;
        }
        h1 {
            font-size: 24px;
            margin: 0;
        }
        .board {
            display: flex;
            justify-content: space-between;
            margin: 20px;
            gap: 20px;
        }
        .column {
            flex: 1;
            background-color: #fff;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .column h2 {
            text-align: center;
            font-size: 20px;
            margin-bottom: 15px;
        }



/* Style pour le rectangle de la tâche */
        .task {
            cursor: pointer; /* Change le curseur au survol */
            background-color: #eaeaea;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 10px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            transition: background-color 0.3s ease; /* Animation pour l'effet hover */
        }



        .task:hover {
            background-color: #dcdcdc; /* Change la couleur au survol */
        }
        .task span {
            font-size: 14px;
        }



        .modal {
    display: none; /* Caché par défaut */
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0, 0, 0, 0.4);
}

/* Modal content */
.modal-content {
    background-color: #fff;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    border-radius: 8px;
}

/* Close button */
.close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    cursor: pointer;
}

.close:hover,
.close:focus {
    color: #000;
    text-decoration: none;
}
    </style>
</head>
<body>
    <div class="header">
        <img src="{% static 'planner/LogoGoat.png' %}" alt="Logo" class="logo" width="50px">
        <h1>Goat's Plan</h1>
    </div>

    <div class="board">
        <!-- To Do Column -->
        <div class="column">
            <h2>To Do</h2>
            {% for task in object_list %}
                {% if task.etat == "TO DO" %}
                    <div class="task" onclick="openModal('{{ task.titre }}', '{{ task.importance }}', '{{ task.deadline }}', '{{ task.commentaire }}', '{{ task.etat }}')">
                            <span><strong>Titre :</strong> {{ task.titre }}</span>
                            <span><strong>Importance :</strong> {{ task.importance }}</span>
                            <span><strong>Deadline :</strong> {{ task.deadline }}</span>
                            <span><strong>Participants :</strong>
                                {% for user in task.utilisateurs.all %}
                                    {{ user.username }}{% if not forloop.last %}, {% endif %}
                                {% empty %}
                                    Aucun participant
                                {% endfor %}
                            </span>
                    </div>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Doing Column -->
        <div class="column">
            <h2>Doing</h2>
            {% for task in object_list %}
                {% if task.etat == "DOING" %}
                        <div class="task" onclick="openModal('{{ task.titre }}', '{{ task.importance }}', '{{ task.deadline }}', '{{ task.commentaire }}', '{{ task.etat }}')">
                            <span><strong>Titre :</strong> {{ task.titre }}</span>
                            <span><strong>Importance :</strong> {{ task.importance }}</span>
                            <span><strong>Deadline :</strong> {{ task.deadline }}</span>
                            <span><strong>Participants :</strong>
                                {% for user in task.utilisateurs.all %}
                                    {{ user.username }}{% if not forloop.last %}, {% endif %}
                                {% empty %}
                                    Aucun participant
                                {% endfor %}
                            </span>
                        </div>
                {% endif %}
            {% endfor %}
        </div>

        <!-- Done Column -->
        <div class="column">
            <h2>Done</h2>
            {% for task in object_list %}
                {% if task.etat == "DONE" %}
                    <div class="task" onclick="openModal('{{ task.titre }}', '{{ task.importance }}', '{{ task.deadline }}', '{{ task.commentaire }}', '{{ task.etat }}')">
                            <span><strong>Titre :</strong> {{ task.titre }}</span>
                            <span><strong>Importance :</strong> {{ task.importance }}</span>
                            <span><strong>Deadline :</strong> {{ task.deadline }}</span>
                            <span><strong>Participants :</strong>
                                {% for user in task.utilisateurs.all %}
                                    {{ user.username }}{% if not forloop.last %}, {% endif %}
                                {% empty %}
                                    Aucun participant
                                {% endfor %}
                            </span>                    </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>

    <div id="taskModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Détails de la tâche</h2>
            <p><strong>Titre :</strong> <span id="modalTitre"></span></p>
            <p><strong>Importance :</strong> <span id="modalImportance"></span></p>
            <p><strong>Deadline :</strong> <span id="modalDeadline"></span></p>
            <p><strong>Commentaire :</strong> <span id="modalCommentaire"></span></p>
            <p><strong>État :</strong> <span id="modalEtat"></span></p>
        </div>
    </div>


    <script>
    // Récupérer les éléments de la modale
    const modal = document.getElementById("taskModal");
    const closeBtn = document.querySelector(".close");

    // Fonction pour afficher la modale avec les détails
    function openModal(titre, importance, deadline, commentaire, etat) {
        document.getElementById("modalTitre").textContent = titre;
        document.getElementById("modalImportance").textContent = importance;
        document.getElementById("modalDeadline").textContent = deadline;
        document.getElementById("modalCommentaire").textContent = commentaire;
        document.getElementById("modalEtat").textContent = etat;
        modal.style.display = "block";
    }

    // Fermer la modale
    closeBtn.onclick = function() {
        modal.style.display = "none";
    };

    // Fermer la modale si on clique en dehors
    window.onclick = function(event) {
        if (event.target === modal) {
            modal.style.display = "none";
        }
    };
    </script>

</body>
</html>
